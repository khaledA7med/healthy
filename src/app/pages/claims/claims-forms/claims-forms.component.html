<form class="mb-4" [formGroup]="formGroup" (ngSubmit)="onSubmit()" autocomplete="off">
    <ngb-accordion #acc="ngbAccordion" activeIds="1,2,3,4,5,6,7,8,9,10,11">
        <!-- Policy Details -->
        <ngb-panel id="1" title="Policy Details" cardClass="open my-4">
            <ng-template ngbPanelContent="1">
                <div id="collapseTwo" class="accordion-collapse collapse show" aria-labelledby="headingTwo">
                    <div class="container-fluid mb-3">
                        <div class="row">

                            <!-- Claims Types: Medical | Motor | General -->
                            <div class="col-lg-12" *ngIf="!uiState.editMode">
                                <label for="medical">Claims Type: </label>
                                <div class="form-check form-check-inline mx-2">
                                    <input class="form-check-input" id="medical" type="radio"
                                        formControlName="claimType" (change)="claimTypeTogglerEvt()"
                                        [value]="uiState.claimTypes.Medical" checked>
                                    <label class="form-check-label" for="medical">Medical</label>
                                </div>
                                <div class="form-check form-check-inline mx-2">
                                    <input class="form-check-input" id="motor" type="radio" formControlName="claimType"
                                        (change)="claimTypeTogglerEvt()" [value]="uiState.claimTypes.Motor">
                                    <label class="form-check-label" for="motor">Motor</label>
                                </div>
                                <div class="form-check form-check-inline mx-2">
                                    <input class="form-check-input" id="general" type="radio"
                                        formControlName="claimType" (change)="claimTypeTogglerEvt()"
                                        [value]="uiState.claimTypes.General">
                                    <label class="form-check-label" for="general">General</label>
                                </div>
                            </div>
                            <!--./col-->
                        </div>

                        <div class="row my-2">
                            <!-- Client Info -->
                            <div class="col-lg-3 col-md-6 col-sm-12 my-1">
                                <label for="clientInfo" class="asterisk-input">Client Info</label>
                                <div class="input-group input-group-sm">
                                    <input type="text" id="clientInfo" formControlName="clientInfo" readonly
                                        class="form-control form-control-sm"
                                        [ngClass]="{'is-invalid' : uiState.submitted && f.clientInfo?.invalid}"
                                        placeholder="Client Details">
                                    <button class="btn btn-info btn-sm d-flex align-items-center" type="button"
                                        (click)="openModal(request)" *ngIf="!uiState.editMode">
                                        <i class="ri-user-search-fill mx-1"></i>
                                        Search
                                    </button>
                                    <span class="invalid-feedback fw-bold mt-0">Required</span>
                                </div>
                            </div>

                            <!-- Policy No -->
                            <div class="col-lg-3 col-md-6 col-sm-12 my-1">
                                <label for="policyNo" class="asterisk-input">Policy No.</label>
                                <div class="input-group input-group-sm">
                                    <input type="text" id="policyNo" formControlName="policyNo" readonly
                                        class="form-control form-control-sm"
                                        [ngClass]="{'is-invalid' : uiState.submitted && f.policyNo?.invalid}"
                                        placeholder="Policy No.">
                                    <button class="btn btn-info btn-sm d-flex align-items-center" type="button">
                                        <i class="ri-search-line mx-1"></i>
                                        View
                                    </button>
                                    <span class="invalid-feedback fw-bold mt-0">Required</span>
                                </div>
                            </div>

                            <!-- Class Of Business -->
                            <div class="col-lg-3 col-md-6 col-sm-12 my-1">
                                <label for="className" class="asterisk-input">Class Of Business</label>
                                <input type="text" formControlName="className" class="form-control form-control-sm"
                                    [ngClass]="{'is-invalid' : (f.className?.touched || uiState.submitted) && f.className?.invalid}"
                                    placeholder="Class Of Business" id="className" readonly>
                                <span class="invalid-feedback mt-0">Required</span>
                            </div>

                            <!-- Inception Date -->
                            <div class="col-lg-3 col-md-6 col-sm-12 my-1" *ngIf="!uiState.editMode">
                                <label for="dateOfLossFrom">Inception Date</label>
                                <app-gregorian-picker [model]="f.dateOfLossFrom?.value" [required]="false"
                                    [submitted]="uiState.submitted" [disabled]="false"
                                    [readonly]="true"></app-gregorian-picker>
                            </div>

                            <!-- Project Title -->
                            <div class="col-lg-3 col-md-6 col-sm-12 my-1" *ngIf="!uiState.editMode">
                                <label for="projectTitle">Project Title</label>
                                <input type="text" formControlName="projectTitle" class="form-control form-control-sm"
                                    placeholder="Project Title" id="projectTitle" readonly>
                            </div>

                            <!-- Insurance Company -->
                            <div class="col-lg-3 col-md-6 col-sm-12 my-1">
                                <label for="insuranceCompany" class="asterisk-input">Insurance Company</label>
                                <input type="text" formControlName="insuranceCompany"
                                    class="form-control form-control-sm"
                                    [ngClass]="{'is-invalid' : (f.insuranceCompany?.touched || uiState.submitted) && f.insuranceCompany?.invalid}"
                                    placeholder="Insurance Company" id="insuranceCompany" readonly>
                                <span class="invalid-feedback mt-0">Required</span>
                            </div>

                            <!-- Line Of Business -->
                            <div class="col-lg-3 col-md-6 col-sm-12 my-1" *ngIf="!uiState.editMode">
                                <label for="lineOfBusiness" class="asterisk-input">Line Of Business</label>
                                <input type="text" formControlName="lineOfBusiness" class="form-control form-control-sm"
                                    [ngClass]="{'is-invalid' : (f.lineOfBusiness?.touched || uiState.submitted) && f.lineOfBusiness?.invalid}"
                                    placeholder="Line Of Business" id="lineOfBusiness" readonly>
                                <span class="invalid-feedback mt-0">Required</span>
                            </div>

                            <!-- Expiry Date -->
                            <div class="col-lg-3 col-md-6 col-sm-12 my-1" *ngIf="!uiState.editMode">
                                <label for="dateOfLossTo">Expiry Date</label>
                                <app-gregorian-picker [model]="f.dateOfLossTo?.value" [required]="false"
                                    [submitted]="uiState.submitted" [disabled]="false"
                                    [readonly]="true"></app-gregorian-picker>
                            </div>

                            <div class="col-lg-12 col-md-12 col-sm-12 mt-3" *ngIf="!uiState.editMode">
                                <div class="card ribbon-box border shadow-none mb-lg-0 h-100">
                                    <div class="card-body">
                                        <div class="ribbon ribbon-info round-shape">
                                            Clients Outstanding / Overdue Balance
                                        </div>
                                        <div class="ribbon-content mt-4 pt-1 text-muted">
                                            <ngx-simplebar style="max-height: 280px;">
                                                <table class="table align-middle table-nowrap mb-0">
                                                    <thead class="table-light">
                                                        <tr>
                                                            <th scope="col">Insurance Company</th>
                                                            <th scope="col">Policy No.</th>
                                                            <th scope="col" class="text-end">Outstanding Balance</th>
                                                            <th scope="col" class="text-end">Overdue Balance</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr *ngFor="let item of uiState.policies.clientOutStanding">
                                                            <td scope="col">{{item.subAccName}}</td>
                                                            <td scope="col">{{item.policyNo}}</td>
                                                            <td scope="col" class="text-end">{{item.outstandingBalance |
                                                                currency:
                                                                'SAR' : '' }}
                                                            </td>
                                                            <td scope="col" class="text-end">{{item.overDueBalance |
                                                                currency:
                                                                'SAR' : '' }}
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </ngx-simplebar>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <!--./row-->
                    </div>
                    <!--./container-->
                </div>
            </ng-template>
        </ngb-panel>

        <!-- Claim Details -->
        <ngb-panel id="2" title="Claim Details" cardClass="open my-4">
            <ng-template ngbPanelContent="2">
                <div id="collapseTwo" class="accordion-collapse collapse show" aria-labelledby="headingTwo">
                    <div class="container-fluid mb-3">
                        <div class="row">
                            <div class="col-lg-3 col-md-6 col-sm-12">
                                <div class="card ribbon-box border shadow-none">
                                    <div class="card-body">
                                        <div class="ribbon ribbon-info round-shape">
                                            Claim Info
                                        </div>
                                        <div class="ribbon-content mt-4 C-P-Card text-muted">
                                            <div class="mb-2" *ngIf="uiState.editMode">
                                                <label for="claimNo">Claim No</label>
                                                <input type="text" formControlName="claimNo"
                                                    class="form-control form-control-sm" placeholder="Claim No."
                                                    id="claimNo" readonly>
                                            </div>
                                            <div class="mb-2">
                                                <label for="previousClaimsNo">Previous Claims</label>
                                                <input type="text" formControlName="previousClaimsNo"
                                                    class="form-control form-control-sm" placeholder="Previous Claims"
                                                    id="previousClaimsNo" readonly>
                                            </div>
                                            <div class="mb-2">
                                                <label for="insurCompClaimNo">Insurance Claim No.</label>
                                                <input type="text" formControlName="insurCompClaimNo"
                                                    class="form-control form-control-sm"
                                                    placeholder="Insurance Claim No." id="insurCompClaimNo">
                                            </div>
                                            <div class="mb-2">
                                                <label for="insuredClaimNo">Insured Claim No.</label>
                                                <input type="text" formControlName="insuredClaimNo"
                                                    class="form-control form-control-sm" placeholder="Insured Claim No."
                                                    id="insuredClaimNo">
                                            </div>
                                            <div class="mb-2">
                                                <label for="membName" class="asterisk-input">Member/Driver Name</label>
                                                <input type="text" formControlName="membName"
                                                    [ngClass]="{'is-invalid' : (f.membName?.touched || uiState.submitted) && f.membName?.invalid}"
                                                    class="form-control form-control-sm"
                                                    placeholder="Second United Gulf for Healthcare Co." id="membName">
                                                <span class="invalid-feedback fw-bold mt-0">Required</span>
                                            </div>
                                            <div class="mb-2">
                                                <label for="bLAWBNo">BL/AWB No.</label>
                                                <input type="text" formControlName="bLAWBNo"
                                                    class="form-control form-control-sm"
                                                    placeholder="Insurance Claim No." id="bLAWBNo">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card ribbon-box border shadow-none mt-4">
                                    <div class="card-body">
                                        <div class="ribbon ribbon-info round-shape">
                                            Loss Adjuster
                                        </div>
                                        <div class="ribbon-content mt-4 C-P-Card text-muted">
                                            <div class="mb-2">
                                                <label for="lostadjuster">Loss Adjuster</label>
                                                <input type="text" formControlName="lostadjuster"
                                                    class="form-control form-control-sm" placeholder="Loss Adjuster"
                                                    id="lostadjuster">
                                            </div>
                                            <div class="mb-2">
                                                <label for="lostadjusterEmail">
                                                    Loss Adjuster Reference
                                                </label>
                                                <input type="text" formControlName="lostadjusterEmail"
                                                    class="form-control form-control-sm"
                                                    placeholder="Loss Adjuster Reference" id="lostadjusterEmail">
                                            </div>
                                            <div class="mb-2">
                                                <label for="lostadjusterTele">
                                                    Loss Adjuster Contact
                                                </label>
                                                <input type="text" formControlName="lostadjusterTele"
                                                    class="form-control form-control-sm"
                                                    placeholder="Loss Adjuster Contact" id="lostadjusterTele">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-6 col-sm-12">
                                <div class="card ribbon-box border shadow-none">
                                    <div class="card-body">
                                        <div class="ribbon ribbon-info round-shape">
                                            Claim Amount
                                        </div>
                                        <div class="ribbon-content mt-4 C-P-Card text-muted"
                                            formGroupName="claimAmounts">
                                            <div class="row my-2">
                                                <div class="col-lg-5 d-flex align-items-center">
                                                    <div class="d-flex align-items-center">
                                                        <input id="ckClaimAmount" class="me-1" type="checkbox"
                                                            formControlName="ckClaimAmount" *ngIf="!uiState.editMode">
                                                        <label for="ckClaimAmount" class="mb-0">
                                                            Claim Amount
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-lg-7">
                                                    <div class="input-group input-group-sm">
                                                        <input type="text" class="form-control input-text-right"
                                                            formControlName="claimAmount"
                                                            (input)="otherClaimAmountValue()" InputMask
                                                            placeholder="0.00" aria-describedby="SAR">
                                                        <span class="input-group-text"
                                                            style="padding: .25rem .5rem;">SAR</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row my-2" *ngIf="!uiState.editMode">
                                                <div class="col-lg-5 d-flex align-items-center">
                                                    <label for="otherCurrAmount" class="mb-0">
                                                        Other Currency Amount
                                                    </label>
                                                </div>
                                                <div class="col-lg-7">
                                                    <div class="input-group input-group-sm">
                                                        <input type="text" class="form-control input-text-right"
                                                            formControlName="otherCurrAmount" id="otherCurrAmount"
                                                            (input)="claimAmountValueExg()" InputMask placeholder="0.00"
                                                            aria-describedby="SAR">
                                                        <span class="input-group-text">
                                                            <i class="ri-currency-line" style="padding: 0 6px;"></i>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row my-2" *ngIf="!uiState.editMode">
                                                <div class="col-lg-5 d-flex align-items-center">
                                                    <label for="otherCurr" class="mb-0">
                                                        Currency
                                                    </label>
                                                </div>
                                                <div class="col-lg-7">
                                                    <ng-select formControlName="otherCurr" bindLabel="name"
                                                        (change)="currencyBinder($event)" [clearable]="false"
                                                        [items]="(formData | async)?.Currencies!" bindValue="name"
                                                        [loading]="formData ? false : true">
                                                    </ng-select>
                                                    <ng-template ng-option-tmp let-item="item">
                                                        <div>
                                                            {{item.name}}
                                                        </div>
                                                    </ng-template>
                                                </div>
                                            </div>
                                            <div class="row my-2" *ngIf="!uiState.editMode">
                                                <div class="col-lg-5 d-flex align-items-center">
                                                    <label for="exchangeRate" class="mb-0">
                                                        Exchange Rate
                                                    </label>
                                                </div>
                                                <div class="col-lg-7">
                                                    <div class="input-group input-group-sm">
                                                        <input type="text" class="form-control input-text-right"
                                                            formControlName="exchangeRate" id="exchangeRate" InputMask
                                                            placeholder="0.00" aria-describedby="SAR" readonly>
                                                        <span class="input-group-text" id="SAR">
                                                            <i class="ri-exchange-funds-line"
                                                                style="padding: 0 6px;"></i>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row my-2" *ngIf="uiState.editMode">
                                                <div class="col-lg-5 d-flex align-items-center">
                                                    <label for="paid" class="mb-0">
                                                        Paid
                                                    </label>
                                                </div>
                                                <div class="col-lg-7">
                                                    <div class="input-group input-group-sm">
                                                        <input type="text" class="form-control input-text-right"
                                                            formControlName="paid" id="paid" readonly InputMask
                                                            placeholder="0.00" aria-describedby="SAR">
                                                        <span class="input-group-text"
                                                            style="padding: .25rem .5rem;">SAR</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row my-2" *ngIf="uiState.editMode">
                                                <div class="col-lg-5 d-flex align-items-center">
                                                    <label for="deducted" class="mb-0">
                                                        Deducted
                                                    </label>
                                                </div>
                                                <div class="col-lg-7">
                                                    <div class="input-group input-group-sm">
                                                        <input type="text" class="form-control input-text-right"
                                                            formControlName="deducted" id="deducted" readonly InputMask
                                                            placeholder="0.00" aria-describedby="SAR">
                                                        <span class="input-group-text"
                                                            style="padding: .25rem .5rem;">SAR</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row my-2" *ngIf="uiState.editMode">
                                                <div class="col-lg-5 d-flex align-items-center">
                                                    <label for="rejected" class="mb-0">
                                                        Rejected
                                                    </label>
                                                </div>
                                                <div class="col-lg-7">
                                                    <div class="input-group input-group-sm">
                                                        <input type="text" class="form-control input-text-right"
                                                            formControlName="rejected" id="rejected" readonly InputMask
                                                            placeholder="0.00" aria-describedby="SAR">
                                                        <span class="input-group-text"
                                                            style="padding: .25rem .5rem;">SAR</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row my-2" *ngIf="uiState.editMode">
                                                <div class="col-lg-5 d-flex align-items-center">
                                                    <label for="underProcessing" class="mb-0">
                                                        Under Processing
                                                    </label>
                                                </div>
                                                <div class="col-lg-7">
                                                    <div class="input-group input-group-sm">
                                                        <input type="text" class="form-control input-text-right"
                                                            formControlName="underProcessing" id="underProcessing"
                                                            readonly InputMask placeholder="0.00"
                                                            aria-describedby="SAR">
                                                        <span class="input-group-text"
                                                            style="padding: .25rem .5rem;">SAR</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row my-2">
                                                <div class="col-lg-5 d-flex align-items-center">
                                                    <label for="estimatedValue" class="mb-0">
                                                        Estimated Value
                                                    </label>
                                                </div>
                                                <div class="col-lg-7">
                                                    <div class="input-group input-group-sm">
                                                        <input type="text" class="form-control input-text-right"
                                                            formControlName="estimatedValue" id="estimatedValue"
                                                            InputMask placeholder="0.00" aria-describedby="SAR">
                                                        <span class="input-group-text"
                                                            style="padding: .25rem .5rem;">SAR</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row my-2">
                                                <div class="col-lg-5 d-flex align-items-center">
                                                    <label for="salvage" class="mb-0">Salvage</label>
                                                </div>
                                                <div class="col-lg-7">
                                                    <div class="input-group input-group-sm">
                                                        <input type="text" class="form-control input-text-right"
                                                            formControlName="salvage" id="salvage" placeholder="0.00"
                                                            InputMask aria-describedby="SAR">
                                                        <span class="input-group-text"
                                                            style="padding: .25rem .5rem;">SAR</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card ribbon-box border shadow-none mt-3">
                                    <div class="card-body">
                                        <div class="ribbon ribbon-info round-shape">
                                            Contact Details
                                        </div>
                                        <div class="ribbon-content mt-4 C-P-Card text-muted">
                                            <div class="mb-2">
                                                <label for="contactName">Contact Name</label>
                                                <input type="text" formControlName="contactName"
                                                    class="form-control form-control-sm" placeholder="Contact Name"
                                                    id="contactName">
                                            </div>
                                            <div class="mb-2">
                                                <label for="contactEmail">Contact Email</label>
                                                <input type="text" formControlName="contactEmail"
                                                    class="form-control form-control-sm" placeholder="Contact Email"
                                                    id="contactEmail">
                                            </div>
                                            <div class="mb-2">
                                                <label for="contactTele">Contact Tele.</label>
                                                <input type="text" formControlName="contactTele"
                                                    class="form-control form-control-sm" placeholder="Contact Tele."
                                                    id="contactTele">
                                            </div>
                                            <div class="mb-2">
                                                <label for="notes">Notes</label>
                                                <textarea class="form-control form-control-sm" formControlName="notes"
                                                    placeholder="Contact Notes" id="notes" rows="1"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-6 col-sm-12">
                                <div class="card ribbon-box border shadow-none">
                                    <div class="card-body">
                                        <div class="ribbon ribbon-info round-shape">
                                            Dates
                                        </div>
                                        <div class="ribbon-content mt-4 C-P-Card text-muted">
                                            <!-- Intimation Date From Client -->
                                            <div class="mb-2">
                                                <label for="chIntimationDate" class="d-flex align-items-center">
                                                    <input id="chIntimationDate"
                                                        (change)="claimDatesHandler($event, f.intimationDate!)"
                                                        type="checkbox" formControlName="chIntimationDate" class="me-1">
                                                    Intimation Date From Client
                                                </label>
                                                <app-gregorian-picker [model]="f.intimationDate?.value"
                                                    (dateChange)="datesValuePatcher($event, f.intimationDate!)"
                                                    [required]="f.intimationDate?.enabled!"
                                                    [submitted]="(uiState.submitted || f.intimationDate?.touched!) && f.intimationDate?.enabled!"
                                                    [disabled]="f.intimationDate?.disabled!"></app-gregorian-picker>
                                            </div>

                                            <!-- Accident / Bill Date -->
                                            <div class="mb-2">
                                                <label for="chDateOfLoss" class="d-flex align-items-center">
                                                    <input id="chDateOfLoss" type="checkbox"
                                                        (change)="claimDatesHandler($event, f.dateOfLoss!)"
                                                        formControlName="chDateOfLoss" class="me-1">
                                                    Accident / Bill Date
                                                </label>
                                                <app-gregorian-picker [model]="f.dateOfLoss?.value"
                                                    (dateChange)="datesValuePatcher($event, f.dateOfLoss!)"
                                                    [required]="f.dateOfLoss?.enabled!"
                                                    [submitted]="(uiState.submitted || f.dateOfLoss?.touched!) && f.dateOfLoss?.enabled!"
                                                    [disabled]="f.dateOfLoss?.disabled!"></app-gregorian-picker>
                                            </div>

                                            <!-- Receive Date -->
                                            <div class="mb-2">
                                                <label for="chDateOfReceive" class="d-flex align-items-center">
                                                    <input id="chDateOfReceive" formControlName="chDateOfReceive"
                                                        (change)="claimDatesHandler($event, f.dateOfReceive!)"
                                                        type="checkbox" class="me-1"> Receive Date
                                                </label>
                                                <app-gregorian-picker [model]="f.dateOfReceive?.value"
                                                    [required]="f.dateOfReceive?.enabled!"
                                                    (dateChange)="datesValuePatcher($event, f.dateOfReceive!)"
                                                    [submitted]="(uiState.submitted || f.dateOfReceive?.touched!) && f.dateOfReceive?.enabled!"
                                                    [disabled]="f.dateOfReceive?.disabled!"></app-gregorian-picker>
                                            </div>

                                            <!-- Date of Submission-->
                                            <div class="mb-2">
                                                <label for="chDateofSubmission" class="d-flex align-items-center">
                                                    <input id="chDateofSubmission" type="checkbox"
                                                        (change)="claimDatesHandler($event, f.dateOfSubmission!)"
                                                        formControlName="chDateofSubmission" class="me-1"> Date of
                                                    Submission
                                                </label>
                                                <app-gregorian-picker [model]="f.dateOfSubmission?.value"
                                                    [required]="f.dateOfSubmission?.enabled!"
                                                    (dateChange)="datesValuePatcher($event, f.dateOfSubmission!)"
                                                    [submitted]="(uiState.submitted || f.dateOfSubmission?.touched!) && f.dateOfSubmission?.enabled!"
                                                    [disabled]="f.dateOfSubmission?.disabled!"></app-gregorian-picker>
                                            </div>

                                            <!-- Deadline -->
                                            <div class="mb-2">
                                                <label for="chDateOfDeadline" class="d-flex align-items-center">
                                                    <input id="chDateOfDeadline" formControlName="chDateOfDeadline"
                                                        (change)="claimDatesHandler($event, f.dateOfDeadline!)"
                                                        type="checkbox" class="me-1">
                                                    Deadline
                                                </label>
                                                <app-gregorian-picker [model]="f.dateOfDeadline?.value"
                                                    [required]="f.dateOfDeadline?.enabled!"
                                                    (dateChange)="datesValuePatcher($event, f.dateOfDeadline!)"
                                                    [submitted]="(uiState.submitted || f.dateOfDeadline?.touched!) && f.dateOfDeadline?.enabled!"
                                                    [disabled]="f.dateOfDeadline?.disabled!"></app-gregorian-picker>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card ribbon-box border shadow-none mt-4">
                                    <div class="card-body">
                                        <div class="ribbon ribbon-info round-shape">
                                            Claim State
                                        </div>
                                        <div class="ribbon-content mt-4 C-P-Card text-muted">
                                            <div class="my-1">
                                                <label for="status" class="asterisk-input">Claim Status</label>
                                                <ng-select formControlName="status" class="is-invalid"
                                                    placeholder="Claim Status"
                                                    [items]="(formData | async)?.ClaimStatus?.content!"
                                                    [ngClass]="{'is-submitted': (f.status?.touched || uiState.submitted) && f.status?.invalid}"
                                                    bindLabel="name" bindValue="name"
                                                    (change)="getStatusNotes($event.name)"
                                                    [loading]="formData ? false : true">
                                                    <ng-template ng-option-tmp let-item="item">
                                                        <div>{{ item.name }}</div>
                                                    </ng-template>
                                                </ng-select>
                                                <span class="invalid-feedback fw-bold mt-0"
                                                    *ngIf="(f.status?.touched || uiState.submitted) && f.status?.invalid">Required</span>
                                            </div>
                                            <div class="my-1">
                                                <label for="claimStatusNotes" class="asterisk-input">Notes</label>
                                                <ng-select formControlName="claimStatusNotes" class="is-invalid"
                                                    placeholder="Claim Status Notes"
                                                    [items]="uiState.claimLists.statusNotes"
                                                    [ngClass]="{'is-submitted': (f.claimStatusNotes?.touched || uiState.submitted) && f.claimStatusNotes?.invalid}"
                                                    bindLabel="name" bindValue="name"
                                                    [loading]="formData ? false : true">
                                                    <ng-template ng-option-tmp let-item="item">
                                                        <div>{{ item.name }}</div>
                                                    </ng-template>
                                                </ng-select>
                                                <span class="invalid-feedback fw-bold mt-0"
                                                    *ngIf="(f.claimStatusNotes?.touched || uiState.submitted) && f.claimStatusNotes?.invalid">Required</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-6 col-sm-12">
                                <div class="card ribbon-box border shadow-none">
                                    <div class="card-body">
                                        <div class="ribbon ribbon-info round-shape">
                                            Claimant Details
                                        </div>
                                        <div class="ribbon-content mt-4 C-P-Card text-muted">
                                            <!-- Claimant Mobile -->
                                            <div class="my-1">
                                                <label for="claimantMobile">Claimant Mobile</label>
                                                <input type="text" formControlName="claimantMobile"
                                                    class="form-control form-control-sm" placeholder="Claimant Mobile"
                                                    id="claimantMobile">
                                            </div>

                                            <!-- Claimant Email -->
                                            <div class="my-1">
                                                <label for="claimantEmail">Claimant Email</label>
                                                <input type="text" formControlName="claimantEmail"
                                                    class="form-control form-control-sm" placeholder="Claimant Email"
                                                    id="claimantEmail">
                                            </div>

                                            <!-- Claimant IBAN -->
                                            <div class="my-1">
                                                <label for="claimantIBAN">Claimant IBAN</label>
                                                <input type="text" formControlName="claimantIBAN"
                                                    class="form-control form-control-sm" placeholder="Claimant IBAN"
                                                    id="claimantIBAN">
                                            </div>

                                            <!-- Bank Name -->
                                            <div class="my-1">
                                                <label for="bankName" class="asterisk-input">Bank Name</label>
                                                <ng-select formControlName="bankName" class="is-invalid"
                                                    [items]="(formData | async)?.Banks?.content!"
                                                    [ngClass]="{'is-submitted': (f.bankName?.touched || uiState.submitted) && f.bankName?.invalid}"
                                                    bindLabel="name" bindValue="name" placeholder="Bank Name"
                                                    [loading]="formData ? false : true">
                                                    <ng-template ng-option-tmp let-item="item">
                                                        <div>{{ item.name }}</div>
                                                    </ng-template>
                                                </ng-select>
                                                <span class="invalid-feedback fw-bold mt-0"
                                                    *ngIf="(f.bankName?.touched || uiState.submitted) && f.bankName?.invalid">Required</span>
                                            </div>

                                            <!-- Bank Branch -->
                                            <div class="my-1">
                                                <label for="bankBranch">Bank Branch</label>
                                                <input type="text" formControlName="bankBranch"
                                                    class="form-control form-control-sm" placeholder="Bank Branch"
                                                    id="bankBranch">
                                            </div>

                                            <!-- Bank City -->
                                            <div class="my-1">
                                                <label for="bankCity">Bank City</label>
                                                <input type="text" formControlName="bankCity"
                                                    class="form-control form-control-sm" placeholder="Bank City"
                                                    id="bankCity">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card ribbon-box border shadow-none mt-4 mb-lg-0">
                                    <div class="card-body">
                                        <div class="ribbon ribbon-info round-shape">
                                            Required Documents
                                        </div>
                                        <div class="ribbon-content mt-4 pt-1 text-muted">
                                            <table class="table align-middle table-nowrap mb-0">
                                                <thead class="table-light">
                                                    <tr>
                                                        <th scope="col">
                                                            <input type="checkbox" formControlName="chAllDocuments"
                                                                (change)="checkAllDocuments($event)">
                                                        </th>
                                                        <th scope="col">Document Name</th>
                                                    </tr>
                                                </thead>
                                                <tbody formArrayName="requiredDocumentList">
                                                    <tr *ngFor="let c of f.requiredDocumentList.controls; index as i">
                                                        <ng-container [formGroupName]="i">
                                                            <td>
                                                                <input type="checkbox"
                                                                    (change)="addToDocList(i, 'checked')"
                                                                    formControlName="checked">
                                                            </td>
                                                            <td>
                                                                <input type="text" hidden formControlName="item">
                                                                <label for="">{{documentListControl(i,
                                                                    'item').value}}</label>
                                                            </td>
                                                        </ng-container>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--./row-->
                    </div>
                </div>
            </ng-template>
        </ngb-panel>

        <!-- Payments -->
        <ngb-panel id="3" title="Payments" cardClass="open my-4" *ngIf="uiState.editMode">
            <ng-template ngbPanelContent="3">
                <div id="collapseTwo" class="accordion-collapse collapse show" aria-labelledby="headingTwo">
                    <div class="container-fluid mb-3">
                        <div class="row">
                            <div class="ribbon-conten pt-2 text-muted">
                                <div class="card ribbon-box border shadow-none">
                                    <div class="card-body">
                                        <div class="ribbon ribbon-info round-shape">
                                            List Of Payments</div>
                                        <div class="ribbon-content mt-3 text-muted">
                                            <div class="d-flex justify-content-end">
                                                <button type="button" (click)="openPaymentModal()"
                                                    class="ms-auto btn btn-sm btn-soft-primary mb-lg-2 bg-gradient waves-effect waves-light">
                                                    <i class="ri-menu-add-line"></i> Add Payment
                                                </button>
                                            </div>
                                            <ngx-simplebar>
                                                <table class="table align-middle table-nowrap mb-0">
                                                    <thead class="table-light">
                                                        <tr>
                                                            <th scope="col">Status</th>
                                                            <th scope="col" class="text-end">Amount</th>
                                                            <th scope="col">Payment Details</th>
                                                            <th scope="col">Payment Type</th>
                                                            <th scope="col">Bank Name</th>
                                                            <th scope="col">IBAN</th>
                                                            <th scope="col">Created By</th>
                                                            <th scope="col">Created On</th>
                                                            <th scope="col">Date Of Payments</th>
                                                            <th scope="col">Date Of Cheque</th>
                                                            <th scope="col"></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr *ngFor="let pay of uiState.claimLists.payments">
                                                            <td>{{pay.status}}</td>
                                                            <td class="text-end">{{pay.amount | currency: 'SAR' : '' }}
                                                            </td>
                                                            <td>{{pay.paymentDetails}}</td>
                                                            <td>{{pay.paymentType}}</td>
                                                            <td>{{pay.bankName}}</td>
                                                            <td>{{pay.iban}}</td>
                                                            <td>{{pay.savedUser}}</td>
                                                            <td>{{util.formatDate(pay.savedDate)}}</td>
                                                            <td>{{util.formatDate(pay.dateofPayment)}}</td>
                                                            <td>{{util.formatDate(pay.dateofCheque)}}</td>
                                                            <td>
                                                                <button class="btn btn-soft-info btn-sm mx-1"
                                                                    type="button"><i class="ri-printer-line"></i>
                                                                </button>
                                                                <button class="btn btn-soft-success btn-sm mx-1"
                                                                    (click)="openPaymentModal(pay)" type="button"><i
                                                                        class="ri-edit-2-line"></i>
                                                                </button>
                                                                <div ngbDropdown display="dynamic"
                                                                    class="d-inline-block"
                                                                    *ngIf="pay.status !== 'Approved' && !(pay.approved === true || pay.reject === true)"
                                                                    placement="bottom-end">
                                                                    <button type="button"
                                                                        class="btn btn-soft-primary btn-sm"
                                                                        ngbDropdownToggle>
                                                                        <i class="ri-more-fill align-middle"></i>
                                                                    </button>
                                                                    <div ngbDropdownMenu class="dropdown-menu">
                                                                        <button ngbDropdownItem type="button"
                                                                            (click)="approveClaimPayment(pay)">Approve</button>
                                                                        <button ngbDropdownItem type="button"
                                                                            (click)="rejectClaimPayment(pay.sNo!)">Reject</button>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr class="my-1 text-center text-dark fw-bold"
                                                            *ngIf="uiState.claimLists.payments.length === 0">
                                                            <td colspan="100">No Payments To show</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </ngx-simplebar>
                                        </div>
                                        <div class="d-flex justify-content-end">
                                            <div class="row col-4 mb-2 mt-4">
                                                <div class="col-lg-5 d-flex align-items-center justify-content-end">
                                                    <div class="d-flex align-items-center">
                                                        <label for="totalPaymentsAmount" class="mb-0">
                                                            Total Payments:
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-lg-7">
                                                    <div class="input-group input-group-sm">
                                                        <input type="text" class="form-control input-text-right"
                                                            formControlName="totalPaymentsAmount" InputMask
                                                            id="totalPaymentsAmount" placeholder="0.00"
                                                            aria-describedby="SAR" readonly>
                                                        <span class="input-group-text"
                                                            style="padding: .25rem .5rem;">SAR</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--./row-->
                    </div>
                    <!--./container-->
                </div>
            </ng-template>
        </ngb-panel>

        <!-- Approvals -->
        <ngb-panel id="4" title="Approvals" cardClass="open my-4" *ngIf="uiState.editMode">
            <ng-template ngbPanelContent="3">
                <div id="collapseTwo" class="accordion-collapse collapse show" aria-labelledby="headingTwo">
                    <div class="container-fluid mb-3">
                        <div class="card ribbon-box border shadow-none">
                            <div class="card-body">
                                <div class="ribbon ribbon-info round-shape">
                                    List Of Approvals</div>
                                <div class="ribbon-content mt-2 text-muted">
                                    <div class="d-flex justify-content-end">
                                        <button type="button" (click)="openApprovalModal()"
                                            class="ms-auto btn btn-sm btn-soft-primary mb-lg-2 bg-gradient waves-effect waves-light">
                                            <i class="ri-menu-add-line"></i> Add Approval
                                        </button>
                                    </div>
                                    <ngx-simplebar>
                                        <table id="listOfApprovalsTable" class="table align-middle table-nowrap mb-0">
                                            <thead class="table-light">
                                                <tr>
                                                    <th scope="col">Chassis No</th>
                                                    <th scope="col" class="text-end">Labor</th>
                                                    <th scope="col" class="text-end">Towing Changes</th>
                                                    <th scope="col" class="text-end">Spare Parts</th>
                                                    <th scope="col" class="text-end">Material</th>
                                                    <th scope="col" class="text-end">VAT Amount</th>
                                                    <th scope="col" class="text-end">Total Amount</th>
                                                    <th scope="col" class="text-end">Depreciation</th>
                                                    <th scope="col" class="text-end">Deductible / Excess</th>
                                                    <th scope="col" class="text-end">Discounts</th>
                                                    <th scope="col" class="text-end">Total Loss</th>
                                                    <th scope="col" class="text-end">Lumpsum Amount</th>
                                                    <th scope="col" class="text-end">Net Amount</th>
                                                    <th scope="col">Updated By</th>
                                                    <th scope="col">Updated On</th>
                                                    <th scope="col">Created By</th>
                                                    <th scope="col">Created On</th>
                                                    <th scope="col"></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr *ngFor="let app of uiState.claimLists.approvals">
                                                    <td>{{app.chassisNo}}</td>
                                                    <td class="text-end">{{app.labor | currency: 'SAR' : '' }}</td>
                                                    <td class="text-end">{{app.towingCharges | currency: 'SAR' : '' }}
                                                    </td>
                                                    <td class="text-end">{{app.spareParts | currency: 'SAR' : '' }}</td>
                                                    <td class="text-end">{{app.material | currency: 'SAR' : '' }}</td>
                                                    <td class="text-end">{{app.vatAmount | currency: 'SAR' : '' }}</td>
                                                    <td class="text-end">{{app.totalAmount | currency: 'SAR' : '' }}
                                                    </td>
                                                    <td class="text-end">{{app.depreciation | currency: 'SAR' : '' }}
                                                    </td>
                                                    <td class="text-end">{{app.deductibleExcess | currency: 'SAR' : ''
                                                        }}
                                                    </td>
                                                    <td class="text-end">{{app.discounts | currency: 'SAR' : '' }}</td>
                                                    <td class="text-end">{{app.totalLoss | currency: 'SAR' : '' }}</td>
                                                    <td class="text-end">{{app.lumpsumAmount | currency: 'SAR' : '' }}
                                                    </td>
                                                    <td class="text-end">{{app.netAmount | currency: 'SAR' : '' }}</td>
                                                    <td>{{app.updatedBy}}</td>
                                                    <td>{{util.formatDate(app.updatedOn)}}</td>
                                                    <td>{{app.savedUser}}</td>
                                                    <td>{{util.formatDate(app.savedDate)}}</td>
                                                    <td>
                                                        <button class="btn btn-soft-success btn-sm mx-1"
                                                            (click)="openApprovalModal(app)" type="button"><i
                                                                class="ri-edit-2-line"></i>
                                                        </button>
                                                    </td>

                                                </tr>
                                                <tr class="my-1 text-center text-dark fw-bold"
                                                    *ngIf="uiState.claimLists.approvals.length === 0">
                                                    <td colspan="100">No Approvals To show</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </ngx-simplebar>
                                </div>
                                <div class="d-flex justify-content-end">
                                    <div class="row col-4 mb-2 mt-4">
                                        <div class="col-lg-5 d-flex align-items-center justify-content-end">
                                            <div class="lables d-flex align-items-center">
                                                <label for="totalApprovalsAmount" class="mb-0">
                                                    Total Approvals:
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-lg-7">
                                            <div class="input-group input-group-sm">
                                                <input type="text" class="form-control input-text-right"
                                                    formControlName="totalApprovalsAmount" id="totalApprovalsAmount"
                                                    InputMask placeholder="0.00" aria-describedby="SAR" readonly>
                                                <span class="input-group-text" style="padding: .25rem .5rem;">SAR</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--./row-->
                    </div>
                    <!--./container-->
                </div>
            </ng-template>
        </ngb-panel>

        <!-- Invoices -->
        <ngb-panel id="5" title="Invoices" cardClass="open my-4" *ngIf="uiState.editMode">
            <ng-template ngbPanelContent="3">
                <div id="collapseTwo" class="accordion-collapse collapse show" aria-labelledby="headingTwo">
                    <div class="container-fluid mb-3">
                        <div class="row">
                            <div class="card ribbon-box border shadow-none">
                                <div class="card-body">
                                    <div class="ribbon ribbon-info round-shape">
                                        List Of Invoices</div>
                                    <div class="ribbon-content mt-3 C-P-Card text-muted">
                                        <div class="d-flex justify-content-end">
                                            <button type="button" (click)="openInvoicesModal()"
                                                class="ms-auto btn btn-sm btn-soft-primary mb-lg-2 bg-gradient waves-effect waves-light">
                                                <i class="ri-menu-add-line"></i> Add Invoice
                                            </button>
                                        </div>
                                        <table id="listOfInvoicesTable" class="table align-middle table-nowrap mb-0">
                                            <thead class="table-light">
                                                <tr>
                                                    <th scope="col">Invoice No.</th>
                                                    <th scope="col">Invoice Date</th>
                                                    <th scope="col">WIP No.</th>
                                                    <th scope="col">Chassis No.</th>
                                                    <th scope="col" class="text-center">Towing Changes</th>
                                                    <th scope="col" class="text-center">Labor</th>
                                                    <th scope="col" class="text-center">Spare Parts</th>
                                                    <th scope="col" class="text-center">Other</th>
                                                    <th scope="col" class="text-center">Estimated Value</th>
                                                    <th scope="col" class="text-center">VAT Amount</th>
                                                    <th scope="col" class="text-center">Grand Total</th>
                                                    <th scope="col" class="text-center">Deductible Excess</th>
                                                    <th scope="col" class="text-center">Discount</th>
                                                    <th scope="col" class="text-center">Amount Due</th>
                                                    <th scope="col" class="text-center">Updated By</th>
                                                    <th scope="col" class="text-center">Updated On</th>
                                                    <th scope="col" class="text-center">Created By</th>
                                                    <th scope="col" class="text-center">Created On</th>
                                                    <th scope="col">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr class="my-1 text-center text-dark fw-bold"
                                                    *ngIf="uiState.claimLists.invoices.length === 0">
                                                    <td colspan="100">No Invoices To show</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="d-flex justify-content-end">
                                        <div class="row col-4 mb-2 mt-4">
                                            <div class="col-lg-5 d-flex align-items-center justify-content-end">
                                                <div class="lables d-flex align-items-center">
                                                    <label for="invoicesTotalAmountInvoices" class="mb-0">
                                                        Total Invoices:
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-lg-7">
                                                <div class="input-group input-group-sm">
                                                    <input type="text" class="form-control input-text-right"
                                                        name="invoicesTotalAmountInvoices"
                                                        id="invoicesTotalAmountInvoices" placeholder="0.00"
                                                        aria-describedby="SAR" readonly>
                                                    <span class="input-group-text"
                                                        style="padding: .25rem .5rem;">SAR</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--./row-->
                    </div>
                    <!--./container-->
                </div>
            </ng-template>
        </ngb-panel>

        <!-- Rejections/Deductions -->
        <ngb-panel id="6" title="Rejections/Deductions" cardClass="open my-4">
            <ng-template ngbPanelContent="3">
                <div id="collapseTwo" class="accordion-collapse collapse show" aria-labelledby="headingTwo">
                    <div class="container-fluid mb-3">
                        <div class="row">
                            <div class="card ribbon-box border shadow-none">
                                <div class="card-body">
                                    <div class="ribbon ribbon-info round-shape">
                                        List Of Rejected Payments</div>
                                    <div class="ribbon-content mt-3 text-muted">
                                        <div class="d-flex justify-content-end">
                                            <button type="button" [disabled]="f.clientInfo?.invalid"
                                                (click)="addRejectDeduction()"
                                                class="ms-auto btn btn-sm btn-soft-primary mb-lg-2 bg-gradient waves-effect waves-light">
                                                <i class="ri-menu-add-line"></i> Add Reject/Deduct
                                            </button>
                                        </div>
                                        <table class="table align-middle table-nowrap mb-0">
                                            <thead class="table-light">
                                                <tr>
                                                    <th scope="col">Type</th>
                                                    <th scope="col" class="text-end">Amount</th>
                                                    <th scope="col">Rejection / Deduction Reason</th>
                                                    <th scope="col">Notes</th>
                                                    <th scope="col">Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr
                                                    *ngFor="let item of uiState.claimLists.rejectDeductList; let i = index">
                                                    <td scope="col">{{item.type}}</td>
                                                    <td scope="col" class="text-end">
                                                        {{item.amount | currency: 'SAR' : '' }}
                                                    </td>
                                                    <td scope="col">{{item.rejectionReason}}</td>
                                                    <td scope="col">{{item.rejectionNote}}</td>
                                                    <td scope="col">
                                                        <button type="button" class="btn btn-sm btn-soft-danger"
                                                            (click)="removeRejectDeduct(i)">
                                                            <i class="ri-delete-bin-2-line"></i>
                                                        </button>
                                                    </td>
                                                </tr>
                                                <tr class="my-1 text-center text-dark fw-bold"
                                                    *ngIf="uiState.claimLists.rejectDeductList.length === 0">
                                                    <td colspan="100">No Rejections To show</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--./row-->
                    </div>
                    <!--./container-->
                </div>
            </ng-template>
        </ngb-panel>

        <!-- Medical Claims -->
        <ngb-panel id="7" title="Medical Claims" *ngIf="f.claimType?.value === this.uiState.claimTypes.Medical"
            cardClass="open my-4">
            <ng-template ngbPanelContent="3">
                <div id="collapseTwo" class="accordion-collapse collapse show" aria-labelledby="headingTwo">
                    <div class="container-fluid mb-3">
                        <div class="row">
                            <div class="card ribbon-box border shadow-none mb-0">
                                <div class="card-body">
                                    <div class="ribbon ribbon-info round-shape">
                                        Medical Claim Details
                                    </div>
                                    <div class="ribbon-content mt-4 C-P-Card text-muted">
                                        <div class="row" formGroupName="medical">
                                            <div class="col-lg-3 col-md-6 col-ms-12 mb-2">
                                                <label for="medID" class="asterisk-input">Member Card No.</label>
                                                <input type="text" class="form-control form-control-sm"
                                                    [ngClass]="{'is-invalid' : (medical.medID?.touched || uiState.submitted) && medical.medID?.invalid}"
                                                    formControlName="medID" id="medID" placeholder="Member Card No.">
                                                <span class="invalid-feedback fw-bold mt-0">Required</span>
                                            </div>
                                            <div class="col-lg-3 col-md-6 col-ms-12 mb-2">
                                                <label for="medClass" class="asterisk-input">Class</label>
                                                <input type="text" class="form-control form-control-sm"
                                                    [ngClass]="{'is-invalid' : (medical.medClass?.touched || uiState.submitted) && medical.medClass?.invalid}"
                                                    formControlName="medClass" id="medClass" placeholder="Class">
                                                <span class="invalid-feedback fw-bold mt-0">Required</span>
                                            </div>
                                            <div class="col-lg-3 col-md-6 col-ms-12 mb-2">
                                                <label for="hospital" class="asterisk-input">Hospital</label>
                                                <div class="input-group input-group-sm">
                                                    <!-- [items]="(formData | async)?.Hospitals?.content!"  -->
                                                    <ng-select formControlName="hospital"
                                                        class="form-control p-0 border-0 is-invalid"
                                                        [ngClass]="{'is-submitted': (medical.hospital?.touched || uiState.submitted) && medical.hospital?.invalid}"
                                                        bindLabel="name" bindValue="name"
                                                        [loading]="formData ? false : true">
                                                        <ng-template ng-option-tmp let-item="item">
                                                            <div>{{ item.name }}</div>
                                                        </ng-template>
                                                    </ng-select>
                                                    <button class="btn btn-info btn-sm d-flex align-items-center"
                                                        type="button">
                                                        <i class="ri-add-fill mx-1"></i>
                                                    </button>
                                                    <span class="invalid-feedback fw-bold mt-0"
                                                        *ngIf="(medical.hospital?.touched || uiState.submitted) && medical.hospital?.invalid">Required</span>
                                                </div>
                                            </div>

                                            <div class="col-lg-3 col-md-6 col-ms-12 mb-2">
                                                <label for="medCaseType" class="asterisk-input">Case Type</label>
                                                <!-- [items]="(formData | async)?.medCaseTypes?.content!" -->
                                                <ng-select formControlName="medCaseType" class="is-invalid"
                                                    [ngClass]="{'is-submitted': (medical.medCaseType?.touched || uiState.submitted) && medical.medCaseType?.invalid}"
                                                    bindLabel="name" bindValue="name"
                                                    [loading]="formData ? false : true">
                                                    <ng-template ng-option-tmp let-item="item">
                                                        <div>{{ item.name }}</div>
                                                    </ng-template>
                                                </ng-select>
                                                <span class="invalid-feedback fw-bold mt-0"
                                                    *ngIf="(medical.medCaseType?.touched || uiState.submitted) && medical.medCaseType?.invalid">Required</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--./row-->
                    </div>
                    <!--./container-->
                </div>
            </ng-template>
        </ngb-panel>

        <!-- Motor Claims -->
        <ngb-panel id="8" title="Motor Claims" *ngIf="f.claimType?.value === this.uiState.claimTypes.Motor"
            cardClass="open my-4">
            <ng-template ngbPanelContent="3">
                <div id="collapseTwo" class="accordion-collapse collapse show" aria-labelledby="headingTwo">
                    <div class="container-fluid mb-3">
                        <div class="row">
                            <div class="card ribbon-box border shadow-none mb-0">
                                <div class="card-body">
                                    <div class="ribbon ribbon-info round-shape">
                                        Motor Claim Details
                                    </div>
                                    <div class="ribbon-content mt-4 text-muted">
                                        <div class="row" formGroupName="motor">
                                            <!-- Car Plat No. -->
                                            <div class="col-lg-3 col-md-6 col-ms-12 my-1">
                                                <label for="carPaletNo" class="asterisk-input">Car Plat No.</label>
                                                <input type="text" class="form-control form-control-sm"
                                                    [ngClass]="{'is-invalid' : (motor.carPaletNo?.touched || uiState.submitted) && motor.carPaletNo?.invalid}"
                                                    formControlName="carPaletNo" id="carPaletNo"
                                                    placeholder="Car Plat No.">
                                                <span class="invalid-feedback fw-bold mt-0">Required</span>
                                            </div>

                                            <!-- Car Make -->
                                            <div class="col-lg-3 col-md-6 col-ms-12 my-1">
                                                <label for="carsMake">Car Make</label>
                                                <!-- [items]="(formData | async)?.carsMakes?.content!" -->
                                                <ng-select formControlName="carsMake" class="is-invalid"
                                                    [ngClass]="{'is-submitted': (motor.carsMake?.touched || uiState.submitted) && motor.carsMake?.invalid}"
                                                    bindLabel="name" bindValue="name"
                                                    [loading]="formData ? false : true">
                                                    <ng-template ng-option-tmp let-item="item">
                                                        <div>{{ item.name }}</div>
                                                    </ng-template>
                                                </ng-select>
                                            </div>

                                            <!-- Accident Number -->
                                            <div class="col-lg-3 col-md-6 col-ms-12 my-1">
                                                <label for="accidentNumber">Accident Number </label>
                                                <input type="text" formControlName="accidentNumber"
                                                    class="form-control form-control-sm" placeholder="Accident Number"
                                                    id="accidentNumber">
                                            </div>

                                            <!-- Claim Type -->
                                            <div class="col-lg-3 col-md-6 col-ms-12 my-1">
                                                <label for="type">Claim Type</label>
                                                <!-- [items]="(formData | async)?.types?.content!" -->
                                                <ng-select formControlName="type" class="is-invalid"
                                                    [ngClass]="{'is-submitted': (motor.type?.touched || uiState.submitted) && motor.type?.invalid}"
                                                    bindLabel="name" bindValue="name"
                                                    [loading]="formData ? false : true">
                                                    <ng-template ng-option-tmp let-item="item">
                                                        <div>{{ item.name }}</div>
                                                    </ng-template>
                                                </ng-select>
                                            </div>

                                            <!-- Chassis/Item No. -->
                                            <div class="col-lg-3 col-md-6 col-ms-12 my-1">
                                                <label for="motorChassisNo">Chassis/Item No.</label>
                                                <textarea rows="1" type="text" class="form-control form-control-sm"
                                                    formControlName="motorChassisNo" id="motorChassisNo"
                                                    placeholder="Chassis/Item No."></textarea>
                                            </div>

                                            <!-- Car Model -->
                                            <div class="col-lg-3 col-md-6 col-ms-12 my-1">
                                                <label for="model">Car Model</label>
                                                <input type="number" class="form-control form-control-sm"
                                                    formControlName="model" id="model" placeholder="Car Model">
                                            </div>

                                            <!-- TPL -->
                                            <div class="col-lg-3 col-md-6 col-ms-12 my-1">
                                                <label for="model">TPL</label>
                                                <div class="input-group input-group-sm">
                                                    <input type="text" class="form-control input-text-right" id="TPL"
                                                        formControlName="TPL" InputMask placeholder="0.00"
                                                        aria-describedby="SAR">
                                                    <span class="input-group-text" id="SAR">SAR</span>
                                                </div>
                                            </div>

                                            <!-- City -->
                                            <div class="col-lg-3 col-md-6 col-ms-12 my-1">
                                                <label for="type">City</label>
                                                <!-- [items]="(formData | async)?.city?.content!" -->
                                                <ng-select formControlName="city" class="is-invalid" bindLabel="name"
                                                    bindValue="name" [loading]="formData ? false : true">
                                                    <ng-template ng-option-tmp let-item="item">
                                                        <div>{{ item.name }}</div>
                                                    </ng-template>
                                                </ng-select>
                                            </div>

                                            <!-- Responsibility -->
                                            <div class="col-lg-3 col-md-6 col-ms-12 my-1">
                                                <label for="mistakePercentage">Responsibility</label>
                                                <div class="input-group input-group-sm">
                                                    <input type="number" class="form-control form-control-sm"
                                                        formControlName="mistakePercentage" id="mistakePercentage"
                                                        placeholder="Responsibility">
                                                    <span class="input-group-text" style="padding: .25rem .5rem;">
                                                        <i class="ri-percent-line"></i>
                                                    </span>
                                                </div>
                                            </div>

                                            <!-- Type Of Repair -->
                                            <div class="col-lg-3 col-md-6 col-ms-12 my-1">
                                                <label for="type">Type Of Repair</label>
                                                <!-- [items]="(formData | async)?.typeOfrepair?.content!" -->
                                                <ng-select formControlName="typeOfrepair" class="is-invalid"
                                                    bindLabel="name" bindValue="name"
                                                    [loading]="formData ? false : true">
                                                    <ng-template ng-option-tmp let-item="item">
                                                        <div>{{ item.name }}</div>
                                                    </ng-template>
                                                </ng-select>
                                            </div>

                                            <!-- Excess -->
                                            <div class="col-lg-3 col-md-6 col-ms-12 my-1">
                                                <label for="excess">Excess</label>
                                                <div class="input-group input-group-sm">
                                                    <input type="text" class="form-control input-text-right" id="excess"
                                                        formControlName="excess" InputMask placeholder="0.00"
                                                        aria-describedby="SAR">
                                                    <span class="input-group-text" id="SAR">SAR</span>
                                                </div>
                                            </div>

                                            <!-- Workshop/Agency -->
                                            <div class="col-lg-3 col-md-6 col-ms-12 my-1">
                                                <label for="workshopAgency">Workshop/Agency</label>
                                                <div class="input-group input-group-sm">
                                                    <!-- [items]="(formData | async)?.workshopAgencys?.content!"  -->
                                                    <ng-select formControlName="workshopAgency"
                                                        class="form-control p-0 border-0 is-invalid" bindLabel="name"
                                                        bindValue="name" [loading]="formData ? false : true">
                                                        <ng-template ng-option-tmp let-item="item">
                                                            <div>{{ item.name }}</div>
                                                        </ng-template>
                                                    </ng-select>
                                                    <button class="btn btn-info btn-sm d-flex align-items-center"
                                                        routerLink="./work">
                                                        <i class="ri-add-fill mx-1"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--./row-->
                    </div>
                    <!--./container-->
                </div>
            </ng-template>
        </ngb-panel>

        <!-- General Claims -->
        <ngb-panel id="9" title="General Claims" *ngIf="f.claimType?.value === this.uiState.claimTypes.General"
            cardClass="open my-4">
            <ng-template ngbPanelContent="3">
                <div id="collapseTwo" class="accordion-collapse collapse show" aria-labelledby="headingTwo">
                    <div class="container-fluid mb-3">
                        <div class="row" formGroupName="general">
                            <div class="col-lg-6 col-md-12">
                                <div class="card ribbon-box border shadow-none mb-0">
                                    <div class="card-body">
                                        <div class="ribbon ribbon-info round-shape">
                                            General Claim Details
                                        </div>
                                        <div class="ribbon-content mt-4 text-muted">
                                            <div class="row">
                                                <div class="col-lg-6 col-md-12">
                                                    <!-- Name of the Injured / deceased -->
                                                    <div class="my-1">
                                                        <label for="nameofInjured">Name of the
                                                            Injured / Deceased</label>
                                                        <input type="text" class="form-control form-control-sm"
                                                            formControlName="nameofInjured" id="nameofInjured"
                                                            placeholder="Name of the Injured / Deceased">
                                                    </div>

                                                    <!-- Nature Of Loss -->
                                                    <div class="my-1">
                                                        <label for="natureofLoss">Nature Of Loss</label>
                                                        <input type="text" class="form-control form-control-sm"
                                                            formControlName="natureofLoss" id="natureofLoss"
                                                            placeholder="Nature Of Loss">
                                                    </div>

                                                    <!-- Loss Location -->
                                                    <div class="my-1">
                                                        <label for="lossLocation">Loss Location</label>
                                                        <input type="text" class="form-control form-control-sm"
                                                            formControlName="lossLocation" id="lossLocation"
                                                            placeholder="Loss Location">
                                                    </div>

                                                    <!-- Policy Excess -->
                                                    <div class="my-1">
                                                        <label for="claimExcess">Policy Excess</label>
                                                        <input type="text" class="form-control form-control-sm"
                                                            formControlName="claimExcess" id="claimExcess"
                                                            placeholder="Policy Excess">
                                                    </div>

                                                    <!-- Interim Payment -->
                                                    <div class="my-1">
                                                        <label for="interimPayment">Interim Payment</label>
                                                        <div class="input-group input-group-sm">
                                                            <input type="text" class="form-control input-text-right"
                                                                id="interimPayment" formControlName="interimPayment"
                                                                InputMask placeholder="0.00" aria-describedby="SAR">
                                                            <span class="input-group-text" id="SAR">SAR</span>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-lg-6 col-md-12">
                                                    <!-- Recovery -->
                                                    <div class="my-1">
                                                        <label for="recovery">Recovery</label>
                                                        <input type="text" class="form-control form-control-sm"
                                                            formControlName="recovery" id="recovery"
                                                            placeholder="Recovery">
                                                    </div>

                                                    <!-- Liability -->
                                                    <div class="my-1">
                                                        <label for="liability">Liability</label>
                                                        <input type="text" class="form-control form-control-sm"
                                                            formControlName="liability" id="liability"
                                                            placeholder="Liability">
                                                    </div>

                                                    <!-- Policy/Certificate No. -->
                                                    <div class="my-1">
                                                        <label for="claimCertificateNo">Policy/Certificate No.</label>
                                                        <input type="text" class="form-control form-control-sm"
                                                            formControlName="claimCertificateNo" id="claimCertificateNo"
                                                            placeholder="Policy/Certificate No.">
                                                    </div>

                                                    <!-- Chassis/Item No. -->
                                                    <div class="my-1">
                                                        <label for="generalChassisNo">Chassis/Item No.</label>
                                                        <input type="text" class="form-control form-control-sm"
                                                            formControlName="generalChassisNo" id="generalChassisNo"
                                                            placeholder="Chassis/Item No.">
                                                    </div>

                                                    <!-- Declaration No. -->
                                                    <div class="my-1">
                                                        <label for="declarationNo">Declaration No.</label>
                                                        <input type="text" class="form-control form-control-sm"
                                                            formControlName="declarationNo" id="declarationNo"
                                                            placeholder="Declaration No.">
                                                    </div>

                                                    <!-- Shipment Name -->
                                                    <div class="my-1">
                                                        <label for="shipmentName">Shipment Name</label>
                                                        <input type="text" class="form-control form-control-sm"
                                                            formControlName="shipmentName" id="shipmentName"
                                                            placeholder="Shipment Name">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-12">
                                <div class="card ribbon-box border shadow-none h-100">
                                    <div class="card-body">
                                        <div class="ribbon ribbon-info round-shape">
                                            Items Details
                                        </div>
                                        <div class="ribbon-content mt-4 pt-1 text-muted">
                                            <table id="generalClaimsItemsTable"
                                                class="table align-middle table-nowrap mb-0">
                                                <thead class="table-light">
                                                    <tr>
                                                        <th scope="col">Item</th>
                                                        <th scope="col" class="text-center">Mandatory</th>
                                                        <th scope="col" class="text-end">Value</th>
                                                        <th scope="col"></th>
                                                    </tr>
                                                </thead>
                                                <tbody formArrayName="claimsGeneral">
                                                    <tr *ngFor="let c of generalList.controls; index as i">
                                                        <ng-container [formGroupName]="i">
                                                            <td>
                                                                <input type="hidden" formControlName="item" />
                                                                <label>{{generalListControls(i, 'item').value}}</label>
                                                            </td>
                                                            <td class="text-center">
                                                                <input type="checkbox" hidden
                                                                    formControlName="mandatory" readonly />
                                                                <span class="text-primary fs-20"
                                                                    *ngIf="generalListControls(i, 'mandatory').value"><i
                                                                        class="ri-checkbox-fill"></i></span>
                                                                <span class="fs-20"
                                                                    *ngIf="!generalListControls(i, 'mandatory').value"><i
                                                                        class="ri-checkbox-blank-line"></i></span>
                                                            </td>
                                                            <td class="text-end">
                                                                <input type="text"
                                                                    class="form-control form-control-sm input-text-right"
                                                                    [ngClass]="{'is-invalid': (generalListControls(i, 'value').touched || uiState.submitted) && generalListControls(i, 'value').invalid}"
                                                                    placeholder="0.00" InputMask
                                                                    formControlName="value" />
                                                            </td>
                                                            <td>
                                                                <button type="button" class="btn btn-sm btn-soft-danger"
                                                                    (click)="removeGeneralItem(i)">
                                                                    <i class="ri-delete-bin-2-line"></i>
                                                                </button>
                                                            </td>
                                                        </ng-container>
                                                    </tr>
                                                    <tr *ngIf="generalList.controls.length === 0"
                                                        class="my-1 text-center text-dark fw-bold no-item-contact">
                                                        <td colspan="100">No Items To show</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--./row-->
                    </div>
                    <!--./container-->
                </div>
            </ng-template>
        </ngb-panel>

        <!-- Emails Log -->
        <ngb-panel id="10" title="Emails Log" cardClass="open my-4" *ngIf="uiState.editMode">
            <ng-template ngbPanelContent="3">
                <div id="collapseTwo" class="accordion-collapse collapse show" aria-labelledby="headingTwo">
                    <div class="container-fluid mb-3">
                        <div class="row">
                            <div class="col-xl-6 col-lg-12 col-md-12 mt-2">
                                <div class="card ribbon-box border shadow-none mb-lg-0 h-100">
                                    <div class="card-body">
                                        <div class="ribbon ribbon-info round-shape">
                                            Client's Premium & Company Commissions
                                        </div>
                                        <div class="ribbon-content mt-4 pt-2 text-muted">
                                            <div class="row">

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--./row-->
                    </div>
                    <!--./container-->
                </div>
            </ng-template>
        </ngb-panel>

        <!-- Documents -->
        <ngb-panel id="11" title="Documents" cardClass="open my-4">
            <ng-template ngbPanelContent="5">
                <app-dropzone (files)="documentsList($event)" [UploadedFiles]="docs" #dropzone></app-dropzone>
            </ng-template>
        </ngb-panel>
    </ngb-accordion>

    <!-- Buttons -->
    <div class="card">
        <div class="container-fluid">
            <div class="card-body px-1 py-3">
                <div class="d-flex justify-content-end">
                    <button type="submit" class="btn btn-sm btn-success me-2">
                        <i class="ri-save-2-fill"></i>
                        Save
                    </button>
                    <button type="button" id="sa-warning" *ngIf="!uiState.editMode" (click)="resetForm()"
                        class="btn btn-sm btn-soft-danger">
                        <i class="ri-delete-bin-2-line"></i>
                        Clear
                    </button>
                </div>
            </div>
        </div>
    </div>
</form>


<!-- Policies Search Popup Modal -->
<ng-template #request let-modal>
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Policies Search</h4>
        <button type="button" class="btn-close btn-sm" aria-label="Close" (click)="modal.dismiss()"></button>
    </div>
    <div class="modal-body">
        <div class="row">
            <div class="col-4 mb-2">
                <ng-select [(ngModel)]="uiState.searchRequest.insuranceCompany" #insuranceCompany="ngModel"
                    [items]="(formData | async)?.InsuranceCompanies?.content!" bindLabel="name" bindValue="name"
                    placeholder="Insurance Company" ngbTooltip="Insurance Company" bindLabel="name" bindValue="name"
                    [loading]="formData ? false : true">
                    <ng-template ng-option-tmp let-item="item">
                        <div>{{ item.name }}</div>
                    </ng-template>
                </ng-select>
            </div>
            <div class="col-4 mb-2">
                <ng-select [(ngModel)]="uiState.searchRequest.classOfInsurance" #classOfInsurance="ngModel"
                    [items]="uiState.policies.insuranceClasses" (change)="getLineOfBusiness($event.name)"
                    placeholder="Class Of Business" bindLabel="name" bindValue="name" ngbTooltip="Class Of Business"
                    [readonly]="f.claimType?.value !== uiState.claimTypes.General" [loading]="formData ? false : true">
                    <ng-template ng-option-tmp let-item="item">
                        <div>{{ item.name }}</div>
                    </ng-template>
                </ng-select>
            </div>
            <div class="col-4 mb-2">
                <ng-select [(ngModel)]="uiState.searchRequest.lineOfBusiness" #lineOfBusiness="ngModel"
                    [items]="uiState.policies.lineOfBusiness" placeholder="Line Of Business" bindLabel="name"
                    bindValue="name" ngbTooltip="Line Of Business" [loading]="formData ? false : true">
                    <ng-template ng-option-tmp let-item="item">
                        <div>{{ item.name }}</div>
                    </ng-template>
                </ng-select>
            </div>
            <div class="col-4 mb-2">
                <input type="text" class="form-control form-control-sm" ngbTooltip="Client Name"
                    [(ngModel)]="uiState.searchRequest.clientName" #clientName="ngModel" placeholder="Client Name">
            </div>
            <div class="col-4 mb-2">
                <input type="text" class="form-control form-control-sm" ngbTooltip="Policy No"
                    [(ngModel)]="uiState.searchRequest.policyNo" #policyNo="ngModel" placeholder="Policy No.">
            </div>
            <div class="col-4 mb-2 d-flex justify-content-end">
                <button class="btn btn-sm btn-primary w-25 d-flex" (click)="requestsData.setDataSource()"><i
                        class="ri-search-line mx-2"></i> Search</button>
            </div>
        </div>
        <div class="row mt-5">
            <app-claims-request-list [filter]="uiState.searchRequest" (dataEvent)="fillRequestDataToForm($event)"
                type="request" #requestsData></app-claims-request-list>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-outline-danger btn-sm" (click)="modal.close()">Close</button>
    </div>
</ng-template>