<div class="modal-header py-3">
    <h4 class="modal-title">Medical Active Details</h4>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
</div>
<div class="modal-body bg-light p-3">
    <div class="row">
        <div class="col-lg-4  my-2">
            <!-- Start Client Details Table -->
            <div class="card details-tables pb-3">
                <div class="card-header">
                    <h6 class="card-title text-muted text-uppercase mb-0">Client Details</h6>
                </div>
                <div class="card-body">
                    <div class="table-responsive table-card">
                        <table class="table table-borderless mb-0">
                            <tbody id="client-information-table">
                                <tr>
                                    <th class="fw-semibold">Client ID :</th>
                                    <td>{{ uiState.policyDetails.clientNo }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Client Name :</th>
                                    <td>{{ uiState.policyDetails.clientName }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Producer (Salesman) :</th>
                                    <td>{{ uiState.policyDetails.producer }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <!-- End Client Details Table -->
        </div>

        <div class="col-lg-4  my-2">
            <!-- Start Issue Type Table -->
            <div class="card details-tables pb-3">
                <div class="card-header">
                    <h6 class="card-title text-muted text-uppercase mb-0">Issue Type</h6>
                </div>
                <div class="card-body">
                    <div class="table-responsive table-card">
                        <table class="table table-borderless mb-0">
                            <tbody id="policy-issue-type-table-fh">
                                <tr>
                                    <th class="fw-semibold">A/C No :</th>
                                    <td>{{ uiState.policyDetails.accNo }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Policy No :</th>
                                    <td>{{ uiState.policyDetails.policyNo }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Issued By :</th>
                                    <td>{{ uiState.policyDetails.insurComp }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Class of Insurance :</th>
                                    <td>{{ uiState.policyDetails.className }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Line of Business :</th>
                                    <td>{{ uiState.policyDetails.lineOfBusiness }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Issue Date :</th>
                                    <td>{{ (uiState.policyDetails.issueDate != undefined) ?
                                        (uiState.policyDetails.issueDate | date:"dd MMMM,yyyy") : '-' }}
                                    </td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Inception Date :</th>
                                    <td>{{ (uiState.policyDetails.periodFrom != undefined) ?
                                        (uiState.policyDetails.periodFrom | date:"dd MMMM,yyyy") : '-' }}
                                    </td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Expiry Date :</th>
                                    <td>{{ (uiState.policyDetails.periodTo != undefined) ?
                                        (uiState.policyDetails.periodTo | date:"dd MMMM,yyyy") : '-' }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Saved By :</th>
                                    <td>{{ uiState.policyDetails.savedBy }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Saved On :</th>
                                    <td>{{ (uiState.policyDetails.savedOn != undefined) ?
                                        (uiState.policyDetails.savedOn | date:"dd MMMM,yyyy") : '-' }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">updated By :</th>
                                    <td>{{ uiState.policyDetails.updatedBy }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Updated On :</th>
                                    <td>{{ (uiState.policyDetails.updatedOn != undefined) ?
                                        (uiState.policyDetails.updatedOn | date:"dd MMMM,yyyy") : '-' }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Cancelled By :</th>
                                    <td>{{ uiState.policyDetails.cancelledUser }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Cancelled On :</th>
                                    <td>{{ (uiState.policyDetails.cancelledDate != undefined) ?
                                        (uiState.policyDetails.cancelledDate | date:"dd MMMM,yyyy") : '-' }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <!-- End Issue Type Table -->
        </div>
    </div>
    <div class="modal-footer pt-0">
        <div class="col-lg-12 col-md-12 col-sm-12 mt-sm-3 d-flex justify-content-between">
            <div class="col-12 d-flex justify-content-end align-items-end">
                <button type="button" class="btn btn-sm btn-outline-info mx-2" *ngIf="uiState.policyDetails.className"
                    (click)="Upload(content)">Upload Medical
                    List</button>
                <button type="button" class="btn btn-sm btn-outline-danger mx-2" (click)="modal.close('Close click')">
                    Close
                </button>
            </div>
        </div>
    </div>

    <ng-template #content let-modal>
        <div class="modal-header">
            <h4 class="modal-title">Excel Data</h4>
            <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
        </div>
        <div class="modal-body">
            <div class="col-12 my-2">
                <p>if you don't have Medical Active File <a class="btn btn-sm btn-info"
                        href="/src/MedicalMembersListTemplate.xls" download><i class="ri-file-download-fill"></i>
                        File</a> download</p>
            </div>
            <div class="col-12  my-2">
                <div class="mb-3">
                    <label for="formFile" class="form-label">Excel File</label>
                    <input class="form-control" type="file" id="formFile" (change)="uploadExeceFile($event)" #fileInput>
                </div>
            </div>
            <div>
                <div class="row">
                    <div class="col-lg-12 table-responsive">
                        <table class="table align-middle table-nowrap mb-0">
                            <thead class="table-light">
                                <tr>
                                    <th scope="col">Id\Iqama No.</th>
                                    <th scope="col">Membership No</th>
                                    <th scope="col">Member Name'</th>
                                    <th scope="col">DOB</th>
                                    <th scope="col">Relation</th>
                                    <th scope="col">Marital Status</th>
                                    <th scope="col">Gender</th>
                                    <th scope="col">Sponsor No</th>
                                    <th scope="col">Endt No</th>
                                    <th scope="col">policy number</th>
                                    <th scope="col">Class</th>
                                    <th scope="col">City</th>
                                    <th scope="col">Staff No</th>
                                    <th scope="col">Premium</th>
                                    <th scope="col">Mobile No</th>
                                    <th scope="col">Nationality</th>
                                    <th scope="col">CCHI Status</th>
                                    <th scope="col">ŸêAction</th>
                                </tr>
                            </thead>
                            <tbody formArray="personsFormArr">
                                <tr *ngFor="let c of DataFormArr.controls; index as i">
                                    <ng-container [formGroup]="DataFormArr.at(i)">
                                        <td>
                                            <input type="text" class="form-control form-control-sm"
                                                placeholder="Id\Iqama No." formControlName="idIqamaNo" />
                                        </td>
                                        <td>
                                            <input type="number" class="form-control form-control-sm"
                                                placeholder="Membership No" formControlName="Membership No" />
                                        </td>
                                        <td>
                                            <input type="text" class="form-control form-control-sm"
                                                placeholder="Member Name'" formControlName="memberName" />
                                        </td>
                                        <td>
                                            <input type="text" class="form-control form-control-sm" placeholder="DOB"
                                                formControlName="dob" />
                                        </td>
                                        <td>
                                            <input type="text" class="form-control form-control-sm"
                                                placeholder="Relation" formControlName="relation" />
                                        </td>
                                        <td>
                                            <input type="text" class="form-control form-control-sm"
                                                placeholder="Marital Status" formControlName="maritalStatus" />
                                        </td>
                                        <td>
                                            <input type="text" class="form-control form-control-sm" placeholder="Gender"
                                                formControlName="gender" />
                                        </td>
                                        <td>
                                            <input type="text" class="form-control form-control-sm"
                                                placeholder="Sponsor No" formControlName="sponsorNo" />
                                        </td>
                                        <td>
                                            <input type="text" class="form-control form-control-sm"
                                                placeholder="Endt No" formControlName="endtNo" />
                                        </td>
                                        <td>
                                            <input type="text" class="form-control form-control-sm"
                                                placeholder="policy number" formControlName="policy number" />
                                        </td>
                                        <td>
                                            <input type="text" class="form-control form-control-sm" placeholder="class"
                                                formControlName="class" />
                                        </td>
                                        <td>
                                            <input type="text" class="form-control form-control-sm" placeholder="City"
                                                formControlName="City" />
                                        </td>
                                        <td>
                                            <input type="text" class="form-control form-control-sm"
                                                placeholder="staff No" formControlName="staffNo" />
                                        </td>
                                        <td>
                                            <input type="text" class="form-control form-control-sm"
                                                placeholder="Premium" formControlName="premium" />
                                        </td>
                                        <td>
                                            <input type="text" class="form-control form-control-sm"
                                                placeholder="Mobile No" formControlName="mobileNo" />
                                        </td>
                                        <td>
                                            <input type="text" class="form-control form-control-sm"
                                                placeholder="Nationality" formControlName="nationality" />
                                        </td>
                                        <td>
                                            <input type="text" class="form-control form-control-sm"
                                                placeholder="CCHI Status" formControlName="cchiStatus" />
                                        </td>
                                        <td>
                                            <button type="button" class="btn btn-sm btn-soft-danger"
                                                (click)="removePerson(i)">
                                                <i class="ri-delete-bin-2-line"></i>
                                            </button>
                                        </td>
                                    </ng-container>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-sm btn-outline-success mx-2">
                Save
            </button>
            <button type="button" class="btn btn-sm btn-outline-info mx-2" (click)="resetFormArr()">
                Reset
            </button>
            <button type="button" class="btn btn-sm btn-outline-danger mx-2" (click)="clearFromArr()">
                Clear
            </button>
            <button type="button" class="btn btn-sm btn-outline-danger"
                (click)="modal.close('Close click')">Close</button>
        </div>
    </ng-template>