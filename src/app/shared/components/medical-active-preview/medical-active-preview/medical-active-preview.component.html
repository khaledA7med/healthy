<div class="modal-header py-3">
    <h4 class="modal-title">Medical Active Details</h4>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
</div>
<div class="modal-body bg-light p-3">
    <div class="row">
        <div class="col-lg-4  my-2">
            <!-- Start Client Details Table -->
            <div class="card details-tables pb-3">
                <div class="card-header">
                    <h6 class="card-title text-muted text-uppercase mb-0">Client Details</h6>
                </div>
                <div class="card-body">
                    <div class="table-responsive table-card">
                        <table class="table table-borderless mb-0">
                            <tbody id="client-information-table">
                                <tr>
                                    <th class="fw-semibold">Request No :</th>
                                    <td>{{ uiState.policyDetails.requestNo }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Client ID :</th>
                                    <td>{{ uiState.policyDetails.clientNo }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Client Name :</th>
                                    <td>{{ uiState.policyDetails.clientName }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Producer (Salesman) :</th>
                                    <td>{{ uiState.policyDetails.producer }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Policy Holder :</th>
                                    <td>{{ uiState.policyDetails.policyHolder }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <!-- End Client Details Table -->
            <!-- Start INVOICE DETAILS Table -->
            <div class="card details-tables mb-5">
                <div class="card-header">
                    <h6 class="card-title text-muted text-uppercase mb-0">Invoice Details</h6>
                </div>
                <div class="card-body">
                    <div class="table-responsive table-card">
                        <table class="table table-borderless mb-0">
                            <tbody id="policy-invoice-details-table-fh">
                                <tr>
                                    <th class="fw-semibold">Sum Insured :</th>
                                    <td class="input-text-right">{{ uiState.policyDetails.sumInsur | currency :
                                        'SAR' : '' }}
                                    </td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Client DN/CN No. :</th>
                                    <td class="input-text-right">{{ uiState.policyDetails.clientDncnno }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Net Premium :</th>
                                    <td class="input-text-right">{{ uiState.policyDetails.netPremium | currency :
                                        'SAR' : ''
                                        }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Policy Fees :</th>
                                    <td class="d-flex align-items-center justify-content-end">
                                        <span *ngIf="uiState.policyDetails.deductFees"
                                            class="text-primary input-text-right"><i class="ri-checkbox-fill"></i>
                                        </span>
                                        <span *ngIf="!uiState.policyDetails.deductFees" class="input-text-right"><i
                                                class="ri-checkbox-blank-line"></i></span>
                                        <label for="Deduct" class="mx-2 mb-0">Deduct
                                        </label>
                                        {{ uiState.policyDetails.fees | currency:
                                        'SAR' : '' }}
                                    </td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">VAT (%) :</th>
                                    <td class="input-text-right">{{ uiState.policyDetails.vatPerc }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">VAT Value :</th>
                                    <td class="input-text-right">{{ uiState.policyDetails.vatValue | currency:
                                        'SAR' : '' }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Totlal Premium :</th>
                                    <td class="input-text-right">{{ uiState.policyDetails.totalPremium | currency:
                                        'SAR' : '' }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Company Comm. DN/CN No. :</th>
                                    <td class="input-text-right">{{ uiState.policyDetails.compCommDncnno }}</td>
                                </tr>
                                <ng-container
                                    *ngIf="(permissions$ | async)?.includes(uiState.privileges.ChHideCompanyCommission)">
                                    <tr>
                                        <th class="fw-semibold">Commission (%) :</th>
                                        <td class="input-text-right">{{ uiState.policyDetails.compCommPerc }}</td>
                                    </tr>
                                    <tr>
                                        <th class="fw-semibold">Company Commission :</th>
                                        <td class="input-text-right">{{ uiState.policyDetails.compComm | currency:
                                            'SAR' : '' }}</td>
                                    </tr>
                                    <tr>
                                        <th class="fw-semibold">Commission VAT :</th>
                                        <td class="input-text-right">{{ uiState.policyDetails.compCommVat |
                                            currency:
                                            'SAR' : '' }}</td>
                                    </tr>
                                </ng-container>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <!-- End INVOICE DETAILS Table -->
        </div>

        <div class="col-lg-4  my-2">
            <!-- Start Issue Type Table -->
            <div class="card details-tables">
                <div class="card-header">
                    <h6 class="card-title text-muted text-uppercase mb-0">Issue Type</h6>
                </div>
                <div class="card-body">
                    <div class="table-responsive table-card">
                        <table class="table table-borderless mb-0">
                            <tbody id="policy-issue-type-table-fh">
                                <tr>
                                    <th class="fw-semibold">A/C No :</th>
                                    <td>{{ uiState.policyDetails.accNo }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Policy No :</th>
                                    <td>{{ uiState.policyDetails.policyNo }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Endors. Type :</th>
                                    <td>{{ uiState.policyDetails.endorsType }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Endors. No :</th>
                                    <td>{{ uiState.policyDetails.endorsNo }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Issued By :</th>
                                    <td>{{ uiState.policyDetails.insurComp }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Class of Insurance :</th>
                                    <td>{{ uiState.policyDetails.className }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Line of Business :</th>
                                    <td>{{ uiState.policyDetails.lineOfBusiness }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Minimum Dreiver Age :</th>
                                    <td>{{ uiState.policyDetails.minDriverAge }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Issue Date :</th>
                                    <td>{{ (uiState.policyDetails.issueDate != undefined) ?
                                        (uiState.policyDetails.issueDate | date:"dd MMMM,yyyy") : '-' }}
                                    </td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Inception Date :</th>
                                    <td>{{ (uiState.policyDetails.periodFrom != undefined) ?
                                        (uiState.policyDetails.periodFrom | date:"dd MMMM,yyyy") : '-' }}
                                    </td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Expiry Date :</th>
                                    <td>{{ (uiState.policyDetails.periodTo != undefined) ?
                                        (uiState.policyDetails.periodTo | date:"dd MMMM,yyyy") : '-' }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Claim DeadLine :</th>
                                    <td>{{ uiState.policyDetails.claimNoOfDays }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">CS Deadline :</th>
                                    <td>{{ uiState.policyDetails.csnoOfDays }}</td>
                                </tr>
                                <tr>
                                    <th class="fw-semibold">Remarks :</th>
                                    <td>{{ uiState.policyDetails.remarks }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <!-- End Issue Type Table -->
        </div>

        <div class="col-lg-4  my-2">
            <!-- Start PAYMENT TERMS Table -->
            <div class="card overflow-hidden">
                <div class="card-header">
                    <h6 class="card-title text-muted text-uppercase mb-0">Payment Terms</h6>
                </div>
                <div class="card-body table-responsive table-card overflow-scroll">
                    <table class="table table-nowrap mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>Payment Date</th>
                                <th>(%)</th>
                                <th>Amount</th>
                                <th>VAT Amount</th>
                                <th>Policy Fees</th>
                            </tr>
                        </thead>
                        <tbody id="payment-terms-table">
                            <ng-container *ngIf="uiState.policyDetails.paymentTermsList?.length !== 0">
                                <tr *ngFor="let item of uiState.policyDetails.paymentTermsList">
                                    <td>{{ item.payDate | date:"mediumDate" }}</td>
                                    <td>{{ item.percentage }}</td>
                                    <td class="input-text-right">{{ item.amount | currency:
                                        'SAR' : '' }}</td>
                                    <td class="input-text-right">{{ item.vatAmount | currency:
                                        'SAR' : '' }}</td>
                                    <td class="input-text-right">{{ item.policyFees | currency:
                                        'SAR' : '' }}</td>
                                </tr>
                            </ng-container>
                            <ng-container *ngIf="uiState.policyDetails.paymentTermsList?.length == 0">
                                <tr>
                                    <td colspan="100">
                                        <div class="alert my-3 alert-danger text-center" role="alert">
                                            No Data Found
                                        </div>
                                    </td>
                                </tr>
                            </ng-container>
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- End PAYMENT TERMS Table -->

            <!-- Start PRODUCERS COMMISSIONS Table -->
            <div class="card" *ngIf="(permissions$ | async)?.includes(uiState.privileges.ChHideProducerCommission)">
                <div class="card-header">
                    <h6 class="card-title text-muted text-uppercase mb-0">Producers Commissions</h6>
                </div>
                <div class="card-body table-responsive table-card">
                    <table class="table table-nowrap mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>Producer</th>
                                <th>(%)</th>
                                <th>Amount</th>
                            </tr>
                        </thead>
                        <!-- policiesProducersCommissions -->
                        <tbody id="producers-commissions-table">
                            <ng-container *ngIf="uiState.policyDetails.producersCommissionsList?.length !== 0">
                                <tr *ngFor="let item of uiState.policyDetails.producersCommissionsList">
                                    <td>{{ item.producer }}</td>
                                    <td>{{ item.percentage }}</td>
                                    <td class="input-text-right">{{ item.amount | currency:
                                        'SAR' : '' }}</td>
                                </tr>
                            </ng-container>
                            <ng-container *ngIf="uiState.policyDetails.producersCommissionsList?.length == 0">
                                <tr>
                                    <td colspan="100">
                                        <div class="alert my-3 alert-danger text-center" role="alert">
                                            No Data Found
                                        </div>
                                    </td>
                                </tr>
                            </ng-container>
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- End PRODUCERS COMMISSIONS Table -->
        </div>

        <div class="col-12  my-2">
            <!-- Start Documents  -->
            <div class="card my-3">
                <div class="card-header">
                    <h6 class="card-title text-muted text-uppercase mb-0">Documents</h6>
                </div>
                <div class="">
                    <table class="table table-responsive table-borderless align-middle mb-0">
                        <thead class="table-light">
                            <tr>
                                <th class="table-header">File Name</th>
                                <th class="table-header">Type</th>
                                <th class="table-header">Size</th>
                                <th class="table-header">Upload Date</th>
                                <th class="table-header">Action</th>
                            </tr>
                        </thead>
                        <tbody id="policy-documents-table">
                            <ng-container *ngIf="uiState.policyDetails.documentList?.length !== 0">
                                <tr *ngFor="let item of uiState.policyDetails.documentLists; let index = index">
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <div class="avatar-sm me-2">
                                                <div
                                                    class="avatar-title bg-soft-primary {{item.colorName}} rounded fs-20">
                                                    <i *ngIf="item.type !== 'image'"
                                                        class="ri-file-{{ item.className }}"></i>
                                                    <img *ngIf="item.type == 'image'" [src]="item.data" alt="" />
                                                </div>
                                            </div>
                                            <div>{{ item.name }}</div>
                                        </div>
                                    </td>
                                    <td>{{ (item.contentDescription?.split("/"))![0] }}</td>
                                    <td>{{ item.size }}</td>
                                    <td>31/1/2023</td>
                                    <td>
                                        <div ngbDropdown placement="top-right" class="dropdown">
                                            <button type="button" class="btn btn-sm btn-soft-info text-center"
                                                ngbDropdownToggle>
                                                <i class="ri-equalizer-fill text-center"></i>
                                            </button>
                                            <div ngbDropdownMenu>
                                                <button ngbDropdownItem class="text-muted"
                                                    (click)="downloadFile(item?.data!)">
                                                    <i class="ri-download-2-fill me-2"></i>
                                                    View
                                                </button>
                                                <button ngbDropdownItem class="text-muted"
                                                    (click)="downloadFile(item?.data!)">
                                                    <i class="ri-download-2-fill me-2"></i>
                                                    Download
                                                </button>

                                                <button ngbDropdownItem (click)="deleteFile(index, item?.data!)"
                                                    class="text-muted">
                                                    <i class="ri-delete-bin-fill me-2"></i>
                                                    Delete
                                                </button>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </ng-container>
                            <ng-container *ngIf="uiState.policyDetails.documentList?.length == 0">
                                <tr>
                                    <td colspan="100">
                                        <div class="alert my-3 alert-danger text-center" role="alert">
                                            No Data Found
                                        </div>
                                    </td>
                                </tr>
                            </ng-container>
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- End Documents  -->
        </div>



    </div>
</div>
<div class="modal-footer pt-0">
    <div class="col-lg-12 col-md-12 col-sm-12 mt-sm-3 d-flex justify-content-between">
        <div class="col-12 d-flex justify-content-end align-items-end">
            <button type="button" class="btn btn-sm btn-outline-info mx-2" (click)="Upload(content)">Upload Medical
                List</button>
            <button type="button" class="btn btn-sm btn-outline-danger mx-2" (click)="modal.close('Close click')">
                Close
            </button>
        </div>
    </div>
</div>

<ng-template #content let-modal>
    <div class="modal-header">
        <h4 class="modal-title">Excel Data</h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
    </div>
    <div class="modal-body">
        <div class="col-12 my-2">
            <p>if you don't have Medical Active File <a class="btn btn-sm btn-info"
                    href="/src/MedicalMembersListTemplate.xls" download><i class="ri-file-download-fill"></i>
                    File</a> download</p>
        </div>
        <div class="col-12  my-2">
            <div class="mb-3">
                <label for="formFile" class="form-label">Excel File</label>
                <input class="form-control" type="file" id="formFile" (change)="uploadExeceFile($event)" #fileInput>
            </div>
        </div>
        <div>
            <div class="row">
                <div class="col-lg-12 table-responsive">
                    <table class="table align-middle table-nowrap mb-0">
                        <thead class="table-light">
                            <tr>
                                <th scope="col">Name</th>
                                <th scope="col">Age</th>
                                <th scope="col">Type</th>
                                <th scope="col">ِAction</th>
                            </tr>
                        </thead>
                        <tbody formArray="personsFormArr">
                            <tr *ngFor="let c of DataFormArr.controls; index as i">
                                <ng-container [formGroup]="DataFormArr.at(i)">
                                    <td>
                                        <input type="text" class="form-control form-control-sm" placeholder="Name"
                                            formControlName="Name" />
                                    </td>
                                    <td>
                                        <input type="number" class="form-control form-control-sm" placeholder="Age"
                                            formControlName="Age" />
                                    </td>
                                    <td>
                                        <input type="text" class="form-control form-control-sm" placeholder="Age"
                                            formControlName="Type" />
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-sm btn-soft-danger"
                                            (click)="removePerson(i)">
                                            <i class="ri-delete-bin-2-line"></i>
                                        </button>
                                    </td>
                                </ng-container>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-sm btn-outline-success mx-2">
            Save
        </button>
        <button type="button" class="btn btn-sm btn-outline-info mx-2" (click)="resetFormArr()">
            Reset
        </button>
        <button type="button" class="btn btn-sm btn-outline-danger mx-2" (click)="clearFromArr()">
            Clear
        </button>
        <button type="button" class="btn btn-sm btn-outline-danger" (click)="modal.close('Close click')">Close</button>
    </div>
</ng-template>


<!-- <tr>
    <th scope="col">Id\Iqama No.</th>
    <th scope="col">Membership No</th>
    <th scope="col">Member Name</th>
    <th scope="col">DOB</th>
    <th scope="col">Relation</th>
    <th scope="col">Marital Status</th>
    <th scope="col">Gender</th>
    <th scope="col">Sponsor No</th>
    <th scope="col">Endt No</th>
    <th scope="col">policy number</th>
    <th scope="col">Class</th>
    <th scope="col">City</th>
    <th scope="col">Staff No</th>
    <th scope="col">Premium</th>
    <th scope="col">Mobile No</th>
    <th scope="col">Nationality</th>
    <th scope="col">CCHI Status</th>
    <th scope="col"></th>
    <th scope="col"></th>
</tr>
</thead>
<tbody id="policy-documents-table">
<ng-container>
    <tr *ngFor="let data of ExcelData">
        <td>{{data['Id\Iqama No.']}}</td>
        <td>{{data['Membership No']}}</td>
        <td>{{data['Member Name']}}</td>
        <td>{{data['DOB']}}</td>
        <td>{{data['Relation']}}</td>
        <td>{{data['Marital Status']}}</td>
        <td>{{data['Gender']}}</td>
        <td>{{data['Sponsor No']}}</td>
        <td>{{data['Endt No']}}</td>
        <td>{{data['policy number']}}</td>
        <td>{{data['Class']}}</td>
        <td>{{data['City']}}</td>
        <td>{{data['Staff No']}}</td>
        <td>{{data['Premium']}}</td>
        <td>{{data['Mobile No']}}</td>
        <td>{{data['Nationality']}}</td>
        <td>{{data['CCHI Status']}}</td>
        <td>
            <button type="button" class="btn btn-sm btn-soft-info me-2"
                (click)="edit(data)"><i class="ri-edit-2-line"></i></button>
        </td>
        <td>
            <button type="button" class="btn btn-sm btn-soft-danger"
                (click)="delete(data)"><i class="ri-delete-bin-2-line"></i></button>
        </td>
    </tr> -->