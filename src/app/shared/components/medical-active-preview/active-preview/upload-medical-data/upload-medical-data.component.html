<div class="modal-header">
    <h4 class="modal-title">Upload Medical Member</h4>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
</div>
<div class="modal-body">
    <div class="col-12 my-2">
        <p>if you don't have Medical File <a class="btn btn-sm btn-info" href="/src/MedicalMembersListTemplate.xlsx"
                download><i class="ri-file-download-fill"></i>
                File</a> download</p>
    </div>
    <div class="col-12  my-2">
        <div class="mb-3">
            <label for="formFile" class="form-label">Upload Excel File</label>
            <input class="form-control form-control-sm" type="file" id="formFile" (change)="uploadExeceFile($event)"
                #fileInput>
        </div>
    </div>
    <div>
        <div class="row">
            <div class="col-lg-12 table-responsive">
                <table class="table align-middle table-nowrap mb-0">
                    <thead class="table-light">
                        <tr>
                            <th scope="col">idIqamaNo</th>
                            <th scope="col">membershipNo</th>
                            <th scope="col">memberName</th>
                            <th scope="col" class="dob">dob</th>
                            <th scope="col">relation</th>
                            <th scope="col">maritalStatus</th>
                            <th scope="col">gender</th>
                            <th scope="col">sponsorNo</th>
                            <th scope="col">endtNo</th>
                            <th scope="col">policyNumber</th>
                            <th scope="col">class</th>
                            <th scope="col">city</th>
                            <th scope="col">staffNo</th>
                            <th scope="col">premium</th>
                            <th scope="col">mobileNo</th>
                            <th scope="col">nationality</th>
                            <th scope="col">cchiStatus</th>
                            <th scope="col">ŸêAction</th>
                        </tr>
                    </thead>
                    <tbody formArray="MedicalDataArr">
                        <tr *ngFor="let c of MedicalDataArr.controls; index as i">
                            <ng-container [formGroup]="MedicalDataArr.at(i)">
                                <td>
                                    <input type="text" class="form-control form-control-sm" placeholder="idIqamaNo"
                                        formControlName="idIqamaNo" />
                                </td>
                                <td>
                                    <input type="text" class="form-control form-control-sm" placeholder="Membership No"
                                        [ngClass]="{
                                        'is-invalid':
                                          (MedicalDataArrControls(i, 'membershipNo').touched ||
                                          uiState.submitted) &&
                                          MedicalDataArrControls(i, 'membershipNo').invalid
                                      }" formControlName="membershipNo" />
                                    <div class="invalid-feedback fw-bold">
                                        Required
                                    </div>
                                </td>
                                <td>
                                    <input type="text" class="form-control form-control-sm" placeholder="Member Name"
                                        [ngClass]="{
                                        'is-invalid':
                                          (MedicalDataArrControls(i, 'memberName').touched ||
                                          uiState.submitted) &&
                                          MedicalDataArrControls(i, 'memberName').invalid
                                      }" formControlName="memberName" />
                                    <div class="invalid-feedback fw-bold">
                                        Required
                                    </div>
                                </td>
                                <td>
                                    <app-gregorian-picker [required]="true"
                                        [model]="MedicalDataArrControls(i, 'dob').value"
                                        (dateChange)="Dates($event, i,'dob')"
                                        [submitted]="MedicalDataArrControls(i, 'dob').invalid && MedicalDataArrControls(i, 'dob').touched"></app-gregorian-picker>
                                </td>
                                <td>
                                    <input type="text" class="form-control form-control-sm" placeholder="Relation"
                                        formControlName="relation" />
                                </td>
                                <td>
                                    <input type="text" class="form-control form-control-sm" placeholder="Marital Status"
                                        formControlName="maritalStatus" />
                                </td>
                                <td>
                                    <input type="text" class="form-control form-control-sm" placeholder="Gender"
                                        formControlName="gender" />
                                </td>
                                <td>
                                    <input type="text" class="form-control form-control-sm" placeholder="Sponsor No"
                                        formControlName="sponsorNo" />
                                </td>
                                <td>
                                    <input type="text" class="form-control form-control-sm" placeholder="endtNo"
                                        formControlName="endtNo" />
                                </td>
                                <td>
                                    <input type="text" class="form-control form-control-sm" placeholder="Policy Number"
                                        formControlName="policyNo" />
                                </td>
                                <td>
                                    <input type="text" class="form-control form-control-sm" placeholder="Class"
                                        formControlName="class" />
                                </td>
                                <td>
                                    <input type="text" class="form-control form-control-sm" placeholder="City"
                                        formControlName="city" />
                                </td>
                                <td>
                                    <input type="text" class="form-control form-control-sm" placeholder="Staff No"
                                        formControlName="staffNo" />
                                </td>
                                <td>
                                    <input type="text" class="form-control form-control-sm" placeholder="Premium"
                                        formControlName="premium" />
                                </td>
                                <td>
                                    <input type="text" class="form-control form-control-sm" placeholder="Mobile No"
                                        formControlName="mobileNo" />
                                </td>
                                <td>
                                    <input type="text" class="form-control form-control-sm" placeholder="Nationality"
                                        formControlName="nationality" />
                                </td>
                                <td>
                                    <input type="text" class="form-control form-control-sm" placeholder="CCHI Status"
                                        formControlName="cchiStatus" />
                                </td>
                                <td>
                                    <button type="button" class="btn btn-sm btn-soft-danger" (click)="removeMedical(i)">
                                        <i class="ri-delete-bin-2-line"></i>
                                    </button>
                                </td>
                            </ng-container>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

    </div>
</div>
<div class="modal-footer">
    <button type="button" class="btn btn-sm btn-outline-success d-flex align-items-center mx-2" (click)="submit()">
        <i class="ri-save-line mx-1"></i> Save
    </button>
    <button type="button" class="btn btn-sm btn-outline-info d-flex align-items-center mx-2"
        (click)="getMedicalActiveData()">
        <i class="ri-refresh-line mx-1"></i> Reset
    </button>
    <button type="button" class="btn btn-sm btn-outline-warning d-flex align-items-center mx-2"
        (click)="clearMedicalDataArr()">
        <i class="ri-delete-bin-line mx-1"></i> Clear
    </button>
    <button type="button" class="btn btn-sm btn-outline-danger d-flex align-items-center"
        (click)="modal.close('Close click')"><i class="ri-close-line mx-1"></i> Close</button>
</div>